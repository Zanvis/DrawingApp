<!-- <div class="flex flex-col items-center p-2 sm:p-4 space-y-2 sm:space-y-4">
        <canvas #canvas 
                class="w-full h-[400px] sm:h-[450px] lg:h-[600px] border border-gray-300 rounded-lg shadow-lg"
                (mousedown)="onMouseDown($event)"
                (mousemove)="onMouseMove($event)"
                (mouseup)="onMouseUp($event)"
                (mouseleave)="onMouseUp($event)"
                (touchstart)="onTouchStart($event)"
                (touchmove)="onTouchMove($event)"
                (touchend)="onTouchEnd($event)"
                (touchcancel)="onTouchEnd($event)"
                (contextmenu)="onRightClick($event)">
        </canvas>

        <div class="flex flex-wrap justify-center gap-2">
                <button (click)="switchPage(currentPageIndex - 1)" 
                        [disabled]="currentPageIndex === 0"
                        class="px-2 py-1 sm:px-3 sm:py-2 bg-gray-200 text-gray-700 rounded-lg shadow hover:bg-gray-300 disabled:opacity-50 text-sm sm:text-base">Previous</button>
                <button (click)="addNewPage()" 
                        class="px-2 py-1 sm:px-3 sm:py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 text-sm sm:text-base">Add Page</button>
                <button (click)="switchPage(currentPageIndex + 1)" 
                        [disabled]="currentPageIndex === pages.length - 1"
                        class="px-2 py-1 sm:px-3 sm:py-2 bg-gray-200 text-gray-700 rounded-lg shadow hover:bg-gray-300 disabled:opacity-50 text-sm sm:text-base">Next</button>
                <button (click)="deletePage(currentPageIndex)" 
                [disabled]="pages.length <= 1"
                class="px-2 py-1 sm:px-3 sm:py-2 bg-red-500 text-white rounded-lg shadow hover:bg-red-600 disabled:opacity-50 text-sm sm:text-base">Delete</button>
        </div>

        <div class="text-gray-600 font-medium text-sm sm:text-base">
                Page {{ currentPageIndex + 1 }} of {{ pages.length }}
        </div>

        <div *ngIf="showContextMenu" 
                [style.left.px]="contextMenuX" 
                [style.top.px]="contextMenuY" 
                class="absolute bg-white border border-gray-300 shadow-md rounded-md z-10">
                <div *ngFor="let item of contextMenuItems" 
                (click)="item.action(); closeContextMenu()" 
                class="px-3 py-1 sm:px-4 sm:py-2 hover:bg-gray-100 cursor-pointer text-sm sm:text-base">
                {{ item.label }}
                <span *ngIf="item.shortcut" class="ml-2 text-gray-500 text-xs sm:text-sm">{{ item.shortcut }}</span>
                </div>
        </div>

        <div class="flex flex-wrap justify-center gap-2 mb-2 sm:mb-4">
                <button *ngFor="let color of predefinedColors" 
                        [style.backgroundColor]="color"
                        (click)="selectColor(color)"
                        class="w-6 h-6 sm:w-8 sm:h-8 rounded-full border border-gray-300 shadow-sm">
                </button>
                <input type="color" [(ngModel)]="currentColor" 
                        (change)="onColorPickerChange()" 
                        class="w-6 h-6 sm:w-8 sm:h-8 rounded-full border border-gray-300 shadow-sm">
                <button (click)="toggleEraser()" 
                        [class.bg-gray-300]="isEraser"
                        class="px-2 py-1 sm:px-3 sm:py-2 border border-gray-300 rounded-lg shadow-sm text-sm sm:text-base">Eraser</button>
                <input type="range" [(ngModel)]="brushSize" min="1" max="50" 
                        class="w-20 sm:w-32 mx-1 sm:mx-2">
                <span class="text-gray-600 font-medium text-sm sm:text-base">Brush: {{brushSize}}</span>
        </div>

        <div class="flex flex-wrap justify-center gap-2 mb-2 sm:mb-4">
                <button (click)="undo()" 
                        [disabled]="actions.length === 0"
                        class="px-2 py-1 sm:px-3 sm:py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 disabled:opacity-50 text-sm sm:text-base">Undo</button>
                <button (click)="redo()" 
                        [disabled]="redoActions.length === 0"
                        class="px-2 py-1 sm:px-3 sm:py-2 bg-green-500 text-white rounded-lg shadow hover:bg-green-600 disabled:opacity-50 text-sm sm:text-base">Redo</button>
                <button (click)="clearCanvas()" 
                        class="px-2 py-1 sm:px-3 sm:py-2 bg-red-500 text-white rounded-lg shadow hover:bg-red-600 text-sm sm:text-base">Clear</button>
                <select (change)="changeBackground($event)" 
                        class="px-2 py-1 sm:px-3 sm:py-2 bg-white border border-gray-300 rounded-lg shadow text-sm sm:text-base">
                        <option value="none">None</option>
                        <option value="grid">Grid</option>
                        <option value="lined">Lined</option>
                </select>
        </div>

        <div class="flex flex-wrap justify-center gap-2">
        <input type="file" 
                (change)="onFileSelected($event)" 
                accept="image/*" 
                class="px-2 py-1 sm:px-3 sm:py-2 border border-gray-300 rounded-lg shadow text-sm sm:text-base">
        <button (click)="exportToPNG()" 
                class="px-2 py-1 sm:px-3 sm:py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 text-sm sm:text-base">Export PNG</button>
        </div>
</div> -->
<div class="flex flex-col h-[90vh] bg-gray-100">
        <!-- Top Toolbar -->
        <div class="flex justify-between items-center p-2 bg-white shadow-md flex-shrink-0 flex-wrap">
                <!-- Left side tools -->
                <div class="flex space-x-2 mb-2 sm:mb-0 flex-wrap">
                        <button (click)="toggleEraser()" 
                                [class.bg-blue-100]="!isEraser"
                                class="p-1 rounded-lg hover:bg-gray-200 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                        <path d="M9.963 8.261c-.566-.585-.536-1.503.047-2.07l5.948-5.768c.291-.281.664-.423 1.035-.423.376 0 .75.146 1.035.44l-8.065 7.821zm-9.778 14.696c-.123.118-.185.277-.185.436 0 .333.271.607.607.607.152 0 .305-.057.423-.171l.999-.972-.845-.872-.999.972zm8.44-11.234l-3.419 3.314c-1.837 1.781-2.774 3.507-3.64 5.916l1.509 1.559c2.434-.79 4.187-1.673 6.024-3.455l3.418-3.315-3.892-4.019zm9.97-10.212l-8.806 8.54 4.436 4.579 8.806-8.538c.645-.626.969-1.458.969-2.291 0-2.784-3.373-4.261-5.405-2.29z"/>
                                </svg>
                        </button>

                        <button (click)="toggleEraser()" 
                                [class.bg-blue-100]="isEraser"
                                class="p-1 rounded-lg hover:bg-gray-200 transition-colors">
                                <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd">
                                        <path d="M5.662 23l-5.369-5.365c-.195-.195-.293-.45-.293-.707 0-.256.098-.512.293-.707l14.929-14.928c.195-.194.451-.293.707-.293.255 0 .512.099.707.293l7.071 7.073c.196.195.293.451.293.708 0 .256-.097.511-.293.707l-11.216 11.219h5.514v2h-12.343zm3.657-2l-5.486-5.486-1.419 1.414 4.076 4.072h2.829zm6.605-17.581l-10.677 10.68 5.658 5.659 10.676-10.682-5.657-5.657z"/>
                                </svg>
                        </button>

                <div class="flex items-center space-x-2 flex-wrap">
                        <!-- Predefined Color Palette -->
                        <div class="flex space-x-1">
                                <div *ngFor="let color of predefinedColors" 
                                (click)="selectColor(color)" 
                                [style.background-color]="color" 
                                class="w-6 h-6 rounded-full cursor-pointer border-2 border-gray-300"></div>
                        </div>

                        <!-- Color Picker -->
                        <input type="color" [(ngModel)]="currentColor" 
                                (change)="onColorPickerChange()" 
                                class="w-6 h-6 rounded-full border-2 border-gray-300">

                        <!-- Background Select -->
                        <select (change)="changeBackground($event)" 
                                class="p-1 text-sm border border-gray-300 rounded-lg bg-white">
                                <option value="none">None</option>
                                <option value="grid">Grid</option>
                                <option value="lined">Lined</option>
                        </select>

                        <!-- Brush Size -->
                        <input type="range" [(ngModel)]="brushSize" min="1" max="50" 
                                class="w-16 sm:w-32 mx-1 sm:mx-2">
                        
                        <!-- Clear Canvas Button -->
                        <button (click)="clearCanvas()" 
                                class="flex items-center space-x-2 p-1 rounded-lg hover:bg-gray-200 transition-colors">
                                Clear
                        </button>
                        </div>
                </div>

                <!-- Right side tools -->
                <div class="flex space-x-2 flex-wrap">
                        <button (click)="undo()" 
                                [disabled]="actions.length === 0"
                                class="p-1 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                                </svg>
                        </button>

                        <button (click)="redo()" 
                                        [disabled]="redoActions.length === 0"
                                        class="p-1 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                        </button>

                        <button (click)="exportToPNG()" 
                                        class="p-1 rounded-lg hover:bg-gray-200 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                        </button>

                        <label class="p-1 rounded-lg hover:bg-gray-200 transition-colors cursor-pointer">
                        <input type="file" 
                                (change)="onFileSelected($event)" 
                                accept="image/*" 
                                class="hidden">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                                </svg>
                        </label>
                </div>
        </div>

        <!-- Main Canvas Area -->
        <div class="flex-grow relative p-2 overflow-hidden">
                <canvas #canvas 
                        class="w-full h-full bg-white shadow-lg border border-gray-300 rounded-lg"
                        (mousedown)="onMouseDown($event)"
                        (mousemove)="onMouseMove($event)"
                        (mouseup)="onMouseUp($event)"
                        (mouseleave)="onMouseUp($event)"
                        (touchstart)="onTouchStart($event)"
                        (touchmove)="onTouchMove($event)"
                        (touchend)="onTouchEnd($event)">
                        (contextmenu)="onRightClick($event)">
                </canvas>
        </div>
        <!-- Bottom Navigation -->
        <div class="flex justify-between items-center p-2 bg-white shadow-md flex-shrink-0">
                <button (click)="switchPage(currentPageIndex - 1)" 
                        [disabled]="currentPageIndex === 0"
                        class="px-3 py-1 text-sm bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed">
                        Previous
                </button>
                <div class="flex items-center space-x-2">
                        <button (click)="deletePage(currentPageIndex)" 
                                        class="p-1 rounded-full bg-red-500 text-white shadow hover:bg-red-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z" clip-rule="evenodd" />
                                </svg>
                        </button>
                        <span class="text-sm text-gray-500">Page {{ currentPageIndex + 1 }} of {{ pages.length }}</span>
                        <button (click)="addNewPage()" 
                                class="p-1 rounded-full bg-blue-500 text-white shadow hover:bg-blue-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                </svg>
                        </button>
                </div>
                <button (click)="switchPage(currentPageIndex + 1)" 
                        [disabled]="currentPageIndex === pages.length - 1"
                        class="px-3 py-1 text-sm bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed">
                        Next
                </button>
        </div>
</div>
<div *ngIf="showContextMenu" 
        [style.left.px]="contextMenuX" 
        [style.top.px]="contextMenuY" 
        class="absolute bg-white border border-gray-300 shadow-md rounded-md z-10">
        <div *ngFor="let item of contextMenuItems" 
                (click)="item.action(); closeContextMenu()" 
                class="px-3 py-1 sm:px-4 sm:py-2 hover:bg-gray-100 cursor-pointer text-sm sm:text-base">
                {{ item.label }}
                <span *ngIf="item.shortcut" class="ml-2 text-gray-500 text-xs sm:text-sm">{{ item.shortcut }}</span>
        </div>
</div>
