<div class="flex flex-col items-center p-2 sm:p-4 space-y-2 sm:space-y-4">
    <canvas #canvas 
        class="w-full h-[400px] sm:h-[450px] lg:h-[600px] border border-gray-300 rounded-lg shadow-lg"
        (mousedown)="onMouseDown($event)"
        (mousemove)="onMouseMove($event)"
        (mouseup)="onMouseUp($event)"
        (mouseleave)="onMouseUp($event)"
        (touchstart)="onTouchStart($event)"
        (touchmove)="onTouchMove($event)"
        (touchend)="onTouchEnd($event)"
        (touchcancel)="onTouchEnd($event)"
        (contextmenu)="onRightClick($event)">
    </canvas>

    <div class="flex flex-wrap justify-center gap-2">
        <button (click)="switchPage(currentPageIndex - 1)" 
                [disabled]="currentPageIndex === 0"
                class="px-2 py-1 sm:px-3 sm:py-2 bg-gray-200 text-gray-700 rounded-lg shadow hover:bg-gray-300 disabled:opacity-50 text-sm sm:text-base">Previous</button>
        <button (click)="addNewPage()" 
                class="px-2 py-1 sm:px-3 sm:py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 text-sm sm:text-base">Add Page</button>
        <button (click)="switchPage(currentPageIndex + 1)" 
                [disabled]="currentPageIndex === pages.length - 1"
                class="px-2 py-1 sm:px-3 sm:py-2 bg-gray-200 text-gray-700 rounded-lg shadow hover:bg-gray-300 disabled:opacity-50 text-sm sm:text-base">Next</button>
        <button (click)="deletePage(currentPageIndex)" 
                [disabled]="pages.length <= 1"
                class="px-2 py-1 sm:px-3 sm:py-2 bg-red-500 text-white rounded-lg shadow hover:bg-red-600 disabled:opacity-50 text-sm sm:text-base">Delete</button>
    </div>

    <div class="text-gray-600 font-medium text-sm sm:text-base">
        Page {{ currentPageIndex + 1 }} of {{ pages.length }}
    </div>

    <div *ngIf="showContextMenu" 
        [style.left.px]="contextMenuX" 
        [style.top.px]="contextMenuY" 
        class="absolute bg-white border border-gray-300 shadow-md rounded-md z-10">
        <div *ngFor="let item of contextMenuItems" 
            (click)="item.action(); closeContextMenu()" 
            class="px-3 py-1 sm:px-4 sm:py-2 hover:bg-gray-100 cursor-pointer text-sm sm:text-base">
            {{ item.label }}
            <span *ngIf="item.shortcut" class="ml-2 text-gray-500 text-xs sm:text-sm">{{ item.shortcut }}</span>
        </div>
    </div>

    <div class="flex flex-wrap justify-center gap-2 mb-2 sm:mb-4">
        <button *ngFor="let color of predefinedColors" 
                [style.backgroundColor]="color"
                (click)="selectColor(color)"
                class="w-6 h-6 sm:w-8 sm:h-8 rounded-full border border-gray-300 shadow-sm">
        </button>
        <input type="color" [(ngModel)]="currentColor" 
                (change)="onColorPickerChange()" 
                class="w-6 h-6 sm:w-8 sm:h-8 rounded-full border border-gray-300 shadow-sm">
        <button (click)="toggleEraser()" 
                [class.bg-gray-300]="isEraser"
                class="px-2 py-1 sm:px-3 sm:py-2 border border-gray-300 rounded-lg shadow-sm text-sm sm:text-base">Eraser</button>
        <input type="range" [(ngModel)]="brushSize" min="1" max="50" 
                class="w-20 sm:w-32 mx-1 sm:mx-2">
        <span class="text-gray-600 font-medium text-sm sm:text-base">Brush: {{brushSize}}</span>
    </div>

    <div class="flex flex-wrap justify-center gap-2 mb-2 sm:mb-4">
        <button (click)="undo()" 
                [disabled]="actions.length === 0"
                class="px-2 py-1 sm:px-3 sm:py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 disabled:opacity-50 text-sm sm:text-base">Undo</button>
        <button (click)="redo()" 
                [disabled]="redoActions.length === 0"
                class="px-2 py-1 sm:px-3 sm:py-2 bg-green-500 text-white rounded-lg shadow hover:bg-green-600 disabled:opacity-50 text-sm sm:text-base">Redo</button>
        <button (click)="clearCanvas()" 
                class="px-2 py-1 sm:px-3 sm:py-2 bg-red-500 text-white rounded-lg shadow hover:bg-red-600 text-sm sm:text-base">Clear</button>
        <select (change)="changeBackground($event)" 
                class="px-2 py-1 sm:px-3 sm:py-2 bg-white border border-gray-300 rounded-lg shadow text-sm sm:text-base">
            <option value="none">None</option>
            <option value="grid">Grid</option>
            <option value="lined">Lined</option>
        </select>
    </div>

    <div class="flex flex-wrap justify-center gap-2">
        <input type="file" 
                (change)="onFileSelected($event)" 
                accept="image/*" 
                class="px-2 py-1 sm:px-3 sm:py-2 border border-gray-300 rounded-lg shadow text-sm sm:text-base">
        <button (click)="exportToPNG()" 
                class="px-2 py-1 sm:px-3 sm:py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 text-sm sm:text-base">Export PNG</button>
    </div>
</div>